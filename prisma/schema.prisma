generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Movie {
  id          String       @id @default(cuid())
  title       String
  titleEn     String?      @map("title_en")
  description String?
  imageUrl    String?      @map("image_url")
  addedBy     String       @map("added_by")
  createdAt   DateTime     @default(now()) @map("created_at")
  votes       MovieVote[]
  nowPlaying  NowPlaying[]

  @@map("fp_movies")
}

model NowPlaying {
  id        String   @id @default(cuid())
  movieId   String   @map("movie_id")
  startedBy String   @map("started_by")
  viewers   String[] @default([])
  startedAt DateTime @default(now()) @map("started_at")
  movie     Movie    @relation(fields: [movieId], references: [id], onDelete: Cascade)

  @@map("fp_now_playing")
}

model MovieVote {
  id        String   @id @default(cuid())
  movieId   String   @map("movie_id")
  voterName String   @map("voter_name")
  createdAt DateTime @default(now()) @map("created_at")
  movie     Movie    @relation(fields: [movieId], references: [id], onDelete: Cascade)

  @@unique([movieId, voterName])
  @@map("fp_movie_votes")
}

model TimeSlot {
  id           String     @id @default(cuid())
  proposedDate String     @map("proposed_date")
  proposedTime String     @map("proposed_time")
  proposedBy   String     @map("proposed_by")
  createdAt    DateTime   @default(now()) @map("created_at")
  votes        TimeVote[]

  @@map("fp_time_slots")
}

model TimeVote {
  id        String   @id @default(cuid())
  slotId    String   @map("slot_id")
  voterName String   @map("voter_name")
  createdAt DateTime @default(now()) @map("created_at")
  slot      TimeSlot @relation(fields: [slotId], references: [id], onDelete: Cascade)

  @@unique([slotId, voterName])
  @@map("fp_time_votes")
}
